---
title: "[Android Core] Fundamentals 是基本原理的意思."
layout: post
categories: sddtc
date: "2020-12-01"
guid: urn:uuid:ea14c80c-353c-4c7c-81bf-d750eeba1cb9
tags:
  - android
---

### 概要

Android 应用可是使用 Kotlin, Java, C++ 这些语言来构建. Android SDK tools 会将你的代码和数据, 资源文件一起编译成 APK 包. 一个 APK 包文件包含了所有和应用相关的资源文件, 并可以安装在支持 Android 系统的设备上。  
每一个 Android app 拥有属于它自己的安全沙盒, 主要的安全特性有以下几点:  
* Android 操作系统是一个多用户的 Linux 系统. 每一个应用是一个不同的用户.
* 默认情况下, Android 系统会给每个 app 分配一个唯一的用户 ID(这个 ID 对 app 是"透明"的). Android 系统会根据该用户 ID 去分配操作权限, 权限作用于app 内的所有资源文件.  
* 每一个进程拥有自己的 VM(virtual machine). app 们之间天然隔离.
* 默认情况下, 当 app 的组件执行时 Android 系统会启动一个 Linux 进程. 当系统需要分配内存给其它应用, 或该应用不再需要运行时, 该进程会被终止.  

Android 系统遵循的是最小权限原则(_the principle of least privilege._). 也就是说, 默认情况下, 每个应用程序只能访问执行其工作所需的组件, 而不能访问其他组件. 这将创建一个非常安全的环境, 在该环境中, 应用程序无法访问未获得其权限的系统部分.  
然而还是有一些方式可以在 app 间共享数据文件, 或者访问系统服务:    
* 可以安排两个应用程序共享相同的 Linux 用户 ID，在这种情况下，它们可以访问彼此的文件。 为了节省系统资源，具有相同用户 ID 的应用程序还可以安排在相同的 Linux 进程中运行并共享相同的 VM。 当然, 这些应用程序还必须使用相同的证书签名。  
*  app 可以向用户直接请求能否获取关于位置信息，照相机，蓝牙连接的权限

### App 组件

应用程序组件是 Android app 的基本组成部分。 每个组件都是系统或用户可以通过其进入您的应用程序的入口点。 有些组件依赖于其他组件。Google 的文档将组件分为了 4 大类, 每种类型都有不同的用途，并且具有不同的生命周期，该生命周期定义了如何创建和销毁组件: 

* Activities
* Services
* Broadcast receivers
* Content providers

#### Activities

Activity 是和用户交互的入口。 它可以用一个单一的 app  屏幕来提供用户交互。 例如， 一个邮件 app 可以有一个 Activity 用来展示用户的新邮件列表，有一个 Activity 用来写邮件，再有一个 Activity 用来读取邮件。 尽管这些活动可以共同协作以在电子邮件 app 中形成极具凝聚力的用户体验，但是每个 Activity 都是彼此独立的。 例如，如果该邮件 app 支持其它 app 打开它，那么它可以选择打开这三种 Activity 的其中之一。 例如，一个拍照 app 可以允许用户分享照片：以邮件的内容的形式分享。 一个 Activity 促进了系统和 app 之间的以下关键交互:

* 持续的跟踪用户当前关心的内容（屏幕上显示的内容），以确保系统继续运行该进程
* 可以知道先前使用的进程有哪些 （包含用户可能会返回的 app Activity（生命周期已经是停止状态），因此可以更加优先地保留这些进程
* 帮助 app 处理其进程，使用户可以恢复到先前状态的活动
* 为 app 提供一种在彼此之间实现用户 flow 的方式，并为系统提供一种协调这些 flow 的方式（最经典的例子是共享）

#### Services

Service 是一个出于通用原因的入口，用于保持 app 在后台运行。 它以组件的形式在后台运行以执行需要长时间的操作，或为远程进程执行工作。 Service 不提供用户交互。 例如，当用户的手机打开其它 app 时， Service 可以仍然在后台为用户播放音乐， 或从远端请求数据。 另一个组件（例如 Activity）可以启动 Service，并使其运行或绑定到该 Service，以便与其进行交互。 实际上，有两个截然不同的语义 Services 告诉系统如何管理 app：启动的 Services 告诉系统使它们保持运行状态直到工作完成。 这可能是为了在后台同步某些数据，或者甚至在用户离开应用程序后播放音乐。在后台同步数据或播放音乐也代表两种不同类型的已启动 Services，这些服务会修改系统处理它们的方式：

* 音乐播放是用户知道的事情，因此 app 可以主动发通知给用户来表明希望自己能一直在系统中保持活跃状态。 在这种情况下，系统知道应该尽力保持该 Service 的进程运行，因为如果服务终止用户会不满意。
* 常规的后台 Service 并不是用户能直接知道的正在运行的服务，因此系统在管理其进程方面具有更大的自由度。 如果它需要 RAM 来处理用户更直接关心的事情则可以终止它（然后在以后的某个时间重新启动该 Service）

绑定的那些服务之所以都在运行状态，是因为其他某个 app（或系统）已经表示要使用该服务。一般情况是 service 向另一个进程提 API 服务。因此系统知道这些进程之间存在依赖性。 如果进程 A 绑定进程 B 中的 Service，则它知道它需要使进程 B （及其 Service）保持为 A 运行。此外，如果进程 A 是某种用户关心的事，那么它也知道将进程 B 同样视为用户关心的事。 由于 Services 的这些灵活性（无论好坏），对于所有更高级别的系统概念而言，Service 已成为非常有用的构建块： 动态壁纸，通知监听器，屏幕保护程序，输入法，可访问性服务以及许多其他核心系统功能都是作为 app 实现的 Services 构建的，系统在应该运行他们的时候绑定这些服务。

#### Broadcast receivers



#### Content providers
  

 














原文: [Application Fundamentals](https://developer.android.com/guide/components/fundamentals)




 



